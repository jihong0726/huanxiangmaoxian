 (cd "$(git rev-parse --show-toplevel)" && git apply --3way <<'EOF' 
diff --git a/index.html b/index.html
index 34d5dda1790f231588581e4003601014ad2f809e..289367ce3b54f1dd51b6f7f200352d96874f9028 100644
--- a/index.html
+++ b/index.html
@@ -487,57 +487,58 @@ const CONFIG = {
         { id: "true_rest", name: "ç™¼è‡ªå¿ƒéˆçš„ä¼‘æ¯", cond: "ç²å¾—æ‰€æœ‰æˆå°±", rarity: "ultra", hidden: true, check: (p) => Game.checkAllAchievements() }
     ]
 };
 
 const Player = {
     hp: 100,
     maxHp: 100,
     baseAtk: 5,
     gold: 100,
     depth: 0,
     class: null,
     equipment: { weapon: null, armor: null, shield: null },
     inventory: { 
         equipment: [], 
         consumable: [ // åˆå§‹è‡ªå¸¶ä¸€ç“¶æ²»ç™‚è—¥æ°´
             { name: "æ²»ç™‚è—¥æ°´", type: "consumable", val: 30, rarity: "common", price: 25, icon: "ğŸ§ª", desc: "æ¢å¾©30é»ç”Ÿå‘½" }
         ], 
         material: [] 
     },
     buff: null,
     achievements: new Set(),
     history: { items: new Set() },
     kill1000Boss: false
 };
 
-const GameState = {
-    phase: "select_class",
-    currentEnemy: null,
-    merchantStock: [],
-    log: [],
-    isLoading: false
-};
+const GameState = {
+    phase: "select_class",
+    currentEnemy: null,
+    merchantStock: [],
+    log: [],
+    isLoading: false,
+    goldenChestCount: 0
+};
 
 const Game = {
     init() {
         // è‡ªå‹•æª¢æŸ¥å­˜æª”
         if (localStorage.getItem('fantasy_adventure_save')) {
             this.loadGame();
         } else {
             this.updateUI();
             // é è¨­é¡¯ç¤ºè·æ¥­é¸æ“‡
         }
     },
 
     // --- Save & Load System (Encrypted) ---
     saveGame() {
         if (Player.hp <= 0) {
             // æ­»äº¡æ™‚æ¸…é™¤å­˜æª”
             localStorage.removeItem('fantasy_adventure_save');
             return;
         }
         if (!Player.class) return; // é‚„æ²’é¸è·æ¥­ä¸å­˜æª”
 
         try {
             // æº–å‚™å­˜æª”è³‡æ–™
             const saveData = {
                 player: {
@@ -859,93 +860,97 @@ const Game = {
      * é‡æ–°è¨ˆç®— MaxHP ä¸¦æ ¹æ“šæ¯”ä¾‹èª¿æ•´ CurrentHP
      */
     recalcStats() {
         // 1. å„²å­˜ç•¶å‰è¡€é‡æ¯”ä¾‹
         const currentRatio = Player.maxHp > 0 ? Player.hp / Player.maxHp : 1; 
 
         // 2. è¨ˆç®—æ–°çš„ MaxHP
         let bonusHp = Player.equipment.armor ? Player.equipment.armor.val : 0;
         const newMaxHp = 100 + bonusHp; 
         
         // 3. æ‡‰ç”¨æ–°çš„ MaxHP
         Player.maxHp = newMaxHp;
 
         // 4. æ ¹æ“šèˆŠæ¯”ä¾‹è¨ˆç®—æ–°çš„ CurrentHP
         let newHp = Math.round(currentRatio * Player.maxHp);
         
         // 5. ç¢ºä¿ CurrentHP ä¸è¶…é MaxHP
         Player.hp = Math.min(newHp, Player.maxHp);
         
         // 6. ç¢ºä¿ CurrentHP ä¸ç‚ºè² 
         if (Player.hp < 0) Player.hp = 0;
         
         this.updateStatsUI();
     },
 
-    nextEvent() {
-    if (Player.hp <= 0) {
-        this.restart();
-        return;
-    }
-
-    Player.depth++;
-    this.checkAchievements();
-    this.log(`>>> é€²å…¥ç¬¬ ${Player.depth} å±¤æ¢ç´¢...`);
-
-    // âœ”ï¸ æ¯ 20 å±¤å›ºå®šå¤§Bossï¼ˆä¸å—å…¶ä»–è¦å‰‡å½±éŸ¿ï¼‰
-    if (Player.depth % 20 === 0) {
-        this.triggerCombat(false, false, true); // ç¬¬ä¸‰å€‹åƒæ•¸ true = å¤§Boss
-        this.updateUI();
-        return;
-    }
-
-    // ğŸ”„ æ¯ 5 å±¤å¾ªç’°ä¸€æ¬¡äº‹ä»¶ï¼ˆç¢ºä¿æ‰€æœ‰äº‹ä»¶éƒ½èƒ½é‡åˆ°ï¼‰
-    const mod = Player.depth % 5;
-
-    if (mod === 1) {
-        this.triggerCombat(false, false);      // âš”ï¸ æ™®é€šæˆ°é¬¥
-    } 
-    else if (mod === 2) {
-        this.triggerMerchant();                // ğŸ›’ å•†äººäº‹ä»¶
-    } 
-    else if (mod === 3) {
-        this.triggerStatue();                  // ğŸ™ ç¥ˆç¦±ç¥åƒï¼ˆæ°¸é å¤©ä½¿ï¼‰
-    } 
-    else if (mod === 4) {
-        // ğŸ—ï¸ å¯¶ç®±ï¼ˆç›œè³Šå¿…å®šé‡‘è‰²å¯¶ç®±ï¼Œå…¶å®ƒè·æ¥­ä¹Ÿçµ¦é«˜å“è³ªï¼‰
-        if (Player.class === "thief") {
-            this.resolveThiefChest();          // é‡‘è‰²å¯¶ç®±ï¼ˆç¥å™¨å„ªå…ˆï¼‰
-        } else {
-            this.triggerChest();               // é«˜å“è³ªæ™®é€šå¯¶ç®±
-        }
-    } 
-    else { // mod === 0
-        this.triggerHeal();                    // ğŸ’– ä¼‘æ¯å›è¡€ã€å®‰å…¨å±¤
-    }
-
-    this.updateUI();
-},
+    getEventTypeForDepth(depth) {
+        if (depth % 20 === 0) return "boss";
+
+        const mod = depth % 5;
+        if (mod === 1) return "combat";
+        if (mod === 2) return "merchant";
+        if (mod === 3) return (Player.hp <= Player.maxHp * 0.8) ? "rest" : "combat";
+        if (mod === 4) return "golden_chest";
+        return "elite"; // mod === 0
+    },
+
+    nextEvent() {
+        if (Player.hp <= 0) {
+            this.restart();
+            return;
+        }
+
+        Player.depth++;
+        this.checkAchievements();
+        this.log(`>>> é€²å…¥ç¬¬ ${Player.depth} å±¤æ¢ç´¢...`);
+
+        const eventType = this.getEventTypeForDepth(Player.depth);
+
+        switch (eventType) {
+            case "boss":
+                this.triggerCombat(false, false, true);
+                break;
+            case "combat":
+                this.triggerCombat(false, false, false, "normal");
+                break;
+            case "merchant":
+                this.triggerMerchant();
+                break;
+            case "rest":
+                this.triggerHeal();
+                break;
+            case "golden_chest":
+                this.triggerChest(true);
+                break;
+            case "elite":
+            default:
+                this.triggerCombat(false, false, false, "elite");
+                break;
+        }
+
+        this.updateUI();
+    },
 
 
     
     // --- Updated Trip Event (0.5% Prob, 70/30 or Hook) ---
     triggerTrip() {
         GameState.phase = "event_end";
         this.triggerAnim('event-icon', 'anim-damage');
         
         // Check for Hook (Guarantees Good Outcome)
         const hookIndex = Player.inventory.material.findIndex(i => i.name === 'é‰¤å­');
         let useHook = false;
         if (hookIndex !== -1) {
             Player.inventory.material.splice(hookIndex, 1); // Consume hook
             useHook = true;
         }
 
         // Check for Ape Class
         const isApe = Player.class === 'ape';
 
         // ç‰¹åˆ¥ç‰ˆï¼šæ°¸é æ˜¯å¥½çµæœ
         const isGoodOutcome = true;
 
         if (isGoodOutcome) {
             // Good Outcome: Catch cliff -> Get random equipment
             // Generate item
@@ -1285,165 +1290,167 @@ const Game = {
         const item = Player.inventory[category][index];
         if (!item) return;
         if (item.type === 'revive' || item.name === 'å½ˆå¼“' || item.name === 'é‰¤å­') {
             alert("é€™ä»¶ç‰©å“ç„¡æ³•å‡ºå”®ï¼");
             return;
         }
 
         let price = item.price;
         if (['weapon', 'armor', 'shield', 'consumable'].includes(item.type)) {
             price = Math.floor(price * 0.8);
         }
         
         if (Player.class === 'merchant') {
             price = Math.floor(price * 1.2);
         }
         
         if(confirm(`ç¢ºå®šè¦ä»¥ ${price} G å‡ºå”® ${item.name} å—ï¼Ÿ`)) {
             Player.inventory[category].splice(index, 1);
             Player.gold += price;
             this.showFloatingText("+ " + price + " G", "yellow");
             this.log(`å‡ºå”® ${item.name} ç²å¾— ${price} G`);
             this.updateUI();
         }
     },
 
-    triggerChest() {
-        GameState.phase = "event_end";
-        this.triggerAnim('event-icon', 'anim-spawn');
-
-        const isThief = Player.class === 'thief';
-        const roll = Math.random();
-        let title = "ğŸ“¦ ç™¼ç¾å¯¶ç®±";
-        let icon = "ğŸ“¦";
-        let desc = "";
-
-        if (isThief) {
-            // ç›œè³Šç‰¹æ¬Šï¼šå¯¶ç®±æ°¸é åªæœ‰å¥½çµæœï¼ˆç„¡ç©ºç®±ã€ç„¡é™·é˜±ï¼‰
-            if (roll < 0.4) {
-                const amount = Math.floor(Math.random() * 50) + 10 + (Player.depth * 2);
-                Player.gold += amount;
-                desc = `ç²å¾—äº† <span class='gold-text'>${amount} G</span>`;
-                this.showFloatingText(`+${amount} G`, "#ffd700");
-            } else if (roll < 0.7) {
-                const item = this.generateSpecificItem(['consumable']);
-                this.addItemToInventory(item);
-                desc = `ç²å¾—äº† <span class='${CONFIG.rarityDisplay[item.rarity].color}'>${item.name}</span>`;
-            } else {
-                const item = this.generateSpecificItem(['weapon', 'armor', 'shield']);
-                this.addItemToInventory(item);
-                desc = `ç²å¾—äº† <span class='${CONFIG.rarityDisplay[item.rarity].color}'>${item.name}</span>`;
-            }
-        } else {
-            // ä¸€èˆ¬è·æ¥­ â†’ ä¿ç•™åŸæœ¬æ©Ÿç‡ï¼ˆå«ç©ºç®±èˆ‡é™·é˜±ï¼‰
-            if (roll < 0.30) {
-                const amount = Math.floor(Math.random() * 50) + 10 + (Player.depth * 2);
-                Player.gold += amount;
-                desc = `ç²å¾—äº† <span class='gold-text'>${amount} G</span>`;
-                this.showFloatingText(`+${amount} G`, "#ffd700");
-            } else if (roll < 0.60) {
-                const item = this.generateSpecificItem(['consumable']);
-                this.addItemToInventory(item);
-                desc = `ç²å¾—äº† <span class='${CONFIG.rarityDisplay[item.rarity].color}'>${item.name}</span>`;
-            } else if (roll < 0.80) {
-                const item = this.generateSpecificItem(['weapon', 'armor', 'shield']);
-                this.addItemToInventory(item);
-                desc = `ç²å¾—äº† <span class='${CONFIG.rarityDisplay[item.rarity].color}'>${item.name}</span>`;
-            } else if (roll < 0.90) {
-                desc = "è£¡é¢ç©ºç©ºå¦‚ä¹Ÿ...";
-            } else {
-                const dmg = Math.floor(Player.maxHp * 0.15);
-                Player.hp = Math.max(0, Player.hp - dmg);
-                desc = `æ˜¯é™·é˜±ï¼å—åˆ°äº† <span class='damage-text'>${dmg}</span> é»å‚·å®³ã€‚`;
-                this.triggerAnim('game-container', 'anim-screen-shake');
-                this.showFloatingText(`-${dmg} HP`, "red");
-                if (Player.hp === 0) {
-                    this.playerDie("æ­»æ–¼å¯¶ç®±é™·é˜±");
-                    return;
-                }
-            }
-        }
-
-        this.renderEvent(title, "ä½ æ‰“é–‹äº†å¯¶ç®±...", desc, icon);
-        this.setButtons("ç¹¼çºŒ", "nextEvent", "ç„¡", null, true);
-    },
+    triggerChest(forceGolden = false) {
+        GameState.phase = "event_end";
+        this.triggerAnim('event-icon', 'anim-spawn');
+
+        const desc = forceGolden ? this.resolveGoldenChestReward() : this.resolveGoldenChestReward();
+        const title = forceGolden ? "ğŸ—ï¸ é‡‘è‰²å¯¶ç®±" : "ğŸ“¦ ç™¼ç¾å¯¶ç®±";
+        const icon = forceGolden ? "ğŸ—ï¸" : "ğŸ“¦";
+
+        this.renderEvent(title, "ä½ æ‰“é–‹äº†å¯¶ç®±...", desc, icon);
+        this.setButtons("ç¹¼çºŒ", "nextEvent", "ç„¡", null, true);
+    },
+
+    resolveGoldenChestReward() {
+        GameState.goldenChestCount += 1;
+
+        const legendaryPool = CONFIG.itemPool.filter(i => i.rarity === 'legendary');
+        const epicPool = CONFIG.itemPool.filter(i => i.rarity === 'epic');
+
+        const hasLegendary = (type) => {
+            const equipped = Player.equipment[type];
+            const inventoryHas = Player.inventory.equipment.some(i => i.type === type && i.rarity === 'legendary');
+            const historyHas = Array.from(Player.history.items).some(name => {
+                const item = CONFIG.itemPool.find(p => p.name === name);
+                return item && item.type === type && item.rarity === 'legendary';
+            });
+            return (equipped && equipped.rarity === 'legendary') || inventoryHas || historyHas;
+        };
+
+        const pickFromPool = (pool) => {
+            if (pool.length === 0) return this.generateRandomItem('boss');
+            const template = pool[Math.floor(Math.random() * pool.length)];
+            return { ...template };
+        };
+
+        let reward;
+
+        if (GameState.goldenChestCount === 1) {
+            reward = pickFromPool(legendaryPool);
+        } else if (!hasLegendary('weapon')) {
+            reward = pickFromPool(legendaryPool.filter(i => i.type === 'weapon'));
+        } else if (!hasLegendary('armor')) {
+            reward = pickFromPool(legendaryPool.filter(i => i.type === 'armor'));
+        } else if (!hasLegendary('shield')) {
+            reward = pickFromPool(legendaryPool.filter(i => i.type === 'shield'));
+        } else {
+            reward = pickFromPool([...legendaryPool, ...epicPool].filter(i => ['weapon', 'armor', 'shield'].includes(i.type)));
+        }
+
+        this.addItemToInventory(reward);
+        const colorClass = reward.rarity ? CONFIG.rarityDisplay[reward.rarity].color : '';
+        this.showFloatingText(reward.name, '#ffd700');
+
+        return `ç²å¾—äº† <span class='${colorClass}'>${reward.name}</span>ï¼`;
+    },
+
+    claimBossChest() {
+        Player.hp = Player.maxHp;
+        this.triggerChest(true);
+    },
 
 
 
     getWeightedMonster() {
         let activeMonsters = [];
         if (Player.depth < 50) {
             let weakWeight = 99 / 4; 
             let strongWeight = 1 / 6; 
             CONFIG.monsters.forEach((m, idx) => {
                 let tempM = {...m};
                 tempM.weight = (idx < 4) ? weakWeight : strongWeight;
                 activeMonsters.push(tempM);
             });
         } else {
             activeMonsters = CONFIG.monsters;
         }
 
         let totalWeight = 0;
         for (let m of activeMonsters) totalWeight += m.weight;
         let randomVal = Math.random() * totalWeight;
         for (let m of activeMonsters) {
             if (randomVal < m.weight) return m;
             randomVal -= m.weight;
         }
         return activeMonsters[0];
     },
 
-    triggerCombat(isForcedBoss, checkTrueForm, isBigBoss) {
-        GameState.phase = "combat";
+    triggerCombat(isForcedBoss, checkTrueForm, isBigBoss, forcedTier = null) {
+        GameState.phase = "combat";
         
         let baseMonster;
         let tier = "normal";
         let canFlee = true;
 
-        if (isForcedBoss) {
-            // å¼·åˆ¶é­”ç‹ï¼ˆåŸæœ¬ 500 / 1000 å±¤é‚è¼¯ï¼‰
-            baseMonster = CONFIG.monsters[9]; 
-            tier = "boss";
-            canFlee = false;   // é€™ç¨®æˆ°é¬¥ç¦æ­¢é€ƒè·‘ï¼ˆæŒ‰ä½ ä¹‹å‰çš„è¨­è¨ˆä¿ç•™ï¼‰
-        } else {
+        if (isForcedBoss) {
+            // å¼·åˆ¶é­”ç‹ï¼ˆåŸæœ¬ 500 / 1000 å±¤é‚è¼¯ï¼‰
+            baseMonster = CONFIG.monsters[9];
+            tier = "boss";
+            canFlee = false;   // é€™ç¨®æˆ°é¬¥ç¦æ­¢é€ƒè·‘ï¼ˆæŒ‰ä½ ä¹‹å‰çš„è¨­è¨ˆä¿ç•™ï¼‰
+        } else {
             baseMonster = this.getWeightedMonster();
             let rand = Math.random();
-            if (Player.depth > 300) {
-                if (rand < 0.10) tier = "normal";
-                else if (rand < 0.55) tier = "elite";
-                else tier = "boss";
-            } else if (Player.depth > 100) {
-                if (rand < 0.10) tier = "boss";
-                else if (rand < 0.60) tier = "elite";
-                else tier = "normal";
-            } else {
-                if (rand < 0.01) tier = "boss";
-                else if (rand < 0.11) tier = "elite";
-                else tier = "normal";
-            }
-        }
+            if (Player.depth > 300) {
+                if (rand < 0.10) tier = "normal";
+                else if (rand < 0.55) tier = "elite";
+                else tier = "boss";
+            } else if (Player.depth > 100) {
+                if (rand < 0.10) tier = "boss";
+                else if (rand < 0.60) tier = "elite";
+                else tier = "normal";
+            } else {
+                if (rand < 0.01) tier = "boss";
+                else if (rand < 0.11) tier = "elite";
+                else tier = "normal";
+            }
+        }
+
+        if (forcedTier) tier = forcedTier;
 
         let hpMul = 1, atkMul = 1;
         let namePrefix = "";
         
         if (Player.depth > 500) {
             hpMul *= 1.5;
             namePrefix += "æ·±æ·µ ";
         }
 
         if (tier === "elite") { 
             hpMul *= 2; 
             atkMul *= 1.5; 
             namePrefix += "èè‹± "; 
         } else if (tier === "boss") { 
             hpMul *= 3; 
             atkMul *= 2; 
             namePrefix += "é¦–é ˜ "; 
         }
 
         // âœ… æ¯ 20 å±¤å¤§ Boss å¼·åŒ– & æ¨™è¨˜
         if (isBigBoss) {
             tier = "boss";
             hpMul *= 1.5;                 // å¤§Bossç¨å¾®å†å¦ä¸€é»ï¼ˆä½ è¦æˆ‘ä¹Ÿå¯ä»¥å¹«ä½ èª¿ï¼‰
             atkMul *= 1.2;
             namePrefix = `ç¬¬ ${Player.depth} å±¤å®ˆé–€è€… `;
@@ -1582,53 +1589,54 @@ const Game = {
             if (s.val <= 0) {
                 logHtml += `<span class='damage-text'>ğŸ’” ä½ çš„ ${s.name} ç¢è£‚äº†ï¼</span><br>`;
                 Player.equipment.shield = null;
                 this.recalcStats(); 
             }
         }
 
         if (applyDamage) {
             Player.hp -= mDmg;
             this.triggerAnim('game-container', 'anim-screen-shake');
             this.showFloatingText(`-${mDmg}`, "red");
             logHtml += `${enemy.name} æ”»æ“Šï¼é€ æˆ ${mCrit ? "<span class='crit-text'>è‡´å‘½ " : ""}${mDmg}${mCrit ? "</span>" : ""} é»å‚·å®³ã€‚`;
         }
         
         this.renderEvent(`âš”ï¸ æˆ°é¬¥ä¸­ - ${enemy.name}`, 
             `æ•µæ–¹ HP: ${Math.max(0, enemy.hp)}`, 
             logHtml, enemy.icon);
 
         if (Player.hp <= 0) {
             this.playerDie(`è¢« ${enemy.name} æ®ºæ­»`);
         } else {
             this.updateUI();
         }
     },
 
-    combatWin() {
-        const enemy = GameState.currentEnemy;
-        GameState.phase = "event_end";
+    combatWin() {
+        const enemy = GameState.currentEnemy;
+        const isBigBoss = enemy && enemy.isBigBoss;
+        GameState.phase = "event_end";
         
         if(Player.depth === 1000 && enemy.tier === 'boss') {
             Player.kill1000Boss = true;
         }
 
         let drops = [];
         let dropText = "";
 
         let gold = enemy.baseGold;
         if (enemy.tier === "elite") gold *= 2;
         if (enemy.tier === "boss") gold *= 5;
         
         Player.gold += gold;
         this.showFloatingText(`+${gold} G`, "#ffd700");
         dropText += `é‡‘å¹£ +${gold} <br>`;
 
         if (enemy.isTrueForm) {
             if (CONFIG.lootData["çœŸå¯¦ä¹‹å¿ƒ"]) {
                 let loot = { ...CONFIG.lootData["çœŸå¯¦ä¹‹å¿ƒ"], name: "çœŸå¯¦ä¹‹å¿ƒ", type: "loot" };
                 drops.push(loot);
             }
         } else {
             if (Math.random() < 0.7) {
                 if (CONFIG.lootData[enemy.drop]) {
                     let loot = { ...CONFIG.lootData[enemy.drop], name: enemy.drop, type: "loot" };
@@ -1638,59 +1646,72 @@ const Game = {
             if (enemy.tier === "elite" || enemy.tier === "boss") {
                 if (Math.random() < 0.3 && CONFIG.lootData[enemy.eliteDrop]) {
                     let loot = { ...CONFIG.lootData[enemy.eliteDrop], name: enemy.eliteDrop, type: "loot" };
                     drops.push(loot);
                 }
             }
             if (enemy.tier === "boss") {
                 if (Math.random() < 0.1 && CONFIG.lootData[enemy.bossDrop]) {
                     let loot = { ...CONFIG.lootData[enemy.bossDrop], name: enemy.bossDrop, type: "loot" };
                     drops.push(loot);
                 }
             }
         }
 
         if (Math.random() < 0.1) {
             drops.push(this.generateRandomItem(enemy.tier));
         }
 
         drops.forEach(item => {
             this.addItemToInventory(item);
             let colorClass = item.rarity ? CONFIG.rarityDisplay[item.rarity].color : "";
             if(item.rarity === 'mythic') colorClass = 'rarity-mythic';
             dropText += `ç²å¾— <span class='${colorClass}'>${item.name}</span><br>`;
         });
 
-        let winTitle = enemy.isTrueForm ? "ğŸ‘‘ å¼’ç¥è€…" : "ğŸ† æˆ°é¬¥å‹åˆ©";
-        let winMsg = enemy.isTrueForm ? "ä½ æ“Šæ•—äº†é­”ç‹çœŸèº«ï¼Œå‚³èªªå°‡æ°¸é æµå‚³ï¼" : "ä½ æ“Šæ•—äº†æ•µäººï¼";
-
-        this.renderEvent(winTitle, winMsg, dropText || "æ²’æœ‰æ‰è½ä»»ä½•ç‰©å“ã€‚", "ğŸ‰");
-        document.getElementById('event-icon').className = "monster-icon"; 
-        
-        this.checkAchievements();
-        this.setButtons("ç¹¼çºŒ", "nextEvent", "ç„¡", null, true);
-        this.updateUI();
+        if (isBigBoss) {
+            Player.hp = Player.maxHp;
+            this.showFloatingText("HP å…¨æ»¿", "#69f0ae");
+        }
+
+        let winTitle = enemy.isTrueForm ? "ğŸ‘‘ å¼’ç¥è€…" : "ğŸ† æˆ°é¬¥å‹åˆ©";
+        let winMsg = enemy.isTrueForm ? "ä½ æ“Šæ•—äº†é­”ç‹çœŸèº«ï¼Œå‚³èªªå°‡æ°¸é æµå‚³ï¼" : "ä½ æ“Šæ•—äº†æ•µäººï¼";
+        if (isBigBoss) {
+            winTitle = "ğŸ‘‘ Boss è¨ä¼æˆåŠŸ";
+            winMsg += "<br><span class='gold-text'>è‡ªå‹•å›æ»¿è¡€ï¼Œä¸¦ç²å¾—ä¸€å€‹é‡‘è‰²å¯¶ç®±ï¼</span>";
+        }
+
+        this.renderEvent(winTitle, winMsg, dropText || "æ²’æœ‰æ‰è½ä»»ä½•ç‰©å“ã€‚", "ğŸ‰");
+        document.getElementById('event-icon').className = "monster-icon";
+
+        this.checkAchievements();
+        if (isBigBoss) {
+            this.setButtons("æ‰“é–‹é‡‘è‰²å¯¶ç®±", "claimBossChest", "ç„¡", null, true);
+        } else {
+            this.setButtons("ç¹¼çºŒ", "nextEvent", "ç„¡", null, true);
+        }
+        this.updateUI();
     },
 
     flee() {
         // âœ… å¤–æ›ç‰ˆï¼šæ‰€æœ‰æ•µäººï¼ˆåŒ…å«æ¯ 20 å±¤çš„å¤§Bossï¼‰é€ƒè·‘å¿…å®šæˆåŠŸ
         const enemy = GameState.currentEnemy;
         GameState.phase = "event_end";
 
         let extraNote = "";
         if (enemy && enemy.isBigBoss) {
             extraNote = "<br><small>ç¬¬ 20 å±¤å€æ•¸çš„å¤§Bossæˆ°ï¼šé€ƒè·‘æˆåŠŸç‡ 100%</small>";
         }
 
         this.renderEvent(
             "ğŸ’¨ é€ƒè·‘æˆåŠŸ", 
             "ä½ æœæ–·æ’¤é€€ï¼Œæ€ªç‰©ç„¡æ³•è¿½ä¸Šä½ ã€‚", 
             extraNote,
             "ğŸƒ"
         );
         document.getElementById('event-icon').className = "monster-icon";
         this.setButtons("ç¹¼çºŒ", "nextEvent", "ç„¡", null, true);
         this.updateUI();
     },
 
 
 
 
EOF
)
