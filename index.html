<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<title>å¹»æƒ³å†’éšª MAX - Abyss Reborn</title>
<style>
    body {
        background: #1c1c1c;
        color: #eee;
        font-family: "Microsoft JhengHei", Arial, sans-serif;
        text-align: center;
        padding: 20px;
    }
    #game {
        max-width: 700px;
        margin: auto;
        background: #2d2d2d;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 0 15px rgba(255,255,255,0.1);
    }
    button {
        background: #444;
        color: #fff;
        padding: 10px 20px;
        border: none;
        border-radius: 6px;
        margin: 5px;
        cursor: pointer;
    }
    button:hover {
        background: #666;
    }
    #log { margin-top: 20px; line-height: 1.6em; }
    #inventory { margin-top: 10px; }
    .highlight { color: gold; font-weight: bold; }
</style>
</head>
<body>
<div id="game">
    <h1>ğŸŒŒ å¹»æƒ³å†’éšª MAX Â· Abyss Reborn</h1>
    <div id="status"></div>
    <div id="log"></div>
    <div id="choices"></div>
    <div id="inventory"></div>
</div>

<script>
/* ========= ç©å®¶è¨­å®š ========= */
let player = {
  hp: 100,
  maxHp: 100,
  atk: 10,
  gold: 50,
  floor: 1,
  artifacts: [],
};

/* ========= ç¥å™¨æ± ï¼ˆä¸é‡è¤‡ï¼‰ ========= */
const artifactPool = [
  "ğŸŒ ç¥ä¹‹å…‰è¼",
  "âš¡ é›·éœ†ä¹‹å¿ƒ",
  "ğŸ”¥ ä¸æ»…ç«ç¨®",
  "ğŸ’ æ°¸æ†æ°´æ™¶",
  "ğŸŒ™ æš—å½±ä¹‹å¥‘",
];

/* ========= å›ºå®šäº‹ä»¶æµç¨‹ ========= */
/*
1 æˆ°é¬¥ â†’ 2 å•†åº— â†’ 3 å›è¡€ â†’ 4 é‡‘ç®±å­ â†’ é‡è¤‡
æ¯ 20 å±¤å›ºå®š Boss
*/
function getEvent(floor) {
  if (floor % 20 === 0) return "boss";
  if (floor % 5 === 1) return "battle";
  if (floor % 5 === 2) return "shop";
  if (floor % 5 === 3) return player.hp >= player.maxHp * 0.8 ? "battle" : "heal";
  if (floor % 5 === 4) return "treasure";
  return "battle";
}

/* ========= UIæ›´æ–° ========= */
function updateUI(msg = "") {
  document.getElementById("status").innerHTML =
    `â¤ï¸ HP: ${player.hp}/${player.maxHp} | âš”ï¸ ATK: ${player.atk} | ğŸ’° Gold: ${player.gold} | ğŸ” Floor: ${player.floor}`;
  document.getElementById("inventory").innerHTML =
    "<strong>ğŸ’ èƒŒåŒ…ï¼š</strong> " +
    (player.artifacts.length ? player.artifacts.join(", ") : "ç©ºç©ºå¦‚ä¹Ÿ");
  if (msg) document.getElementById("log").innerHTML = msg;
}

/* ========= æŒ‰éˆ•æ¸²æŸ“ ========= */
function renderChoices(options) {
  const box = document.getElementById("choices");
  box.innerHTML = "";
  options.forEach(text => {
    let btn = document.createElement("button");
    btn.innerHTML = text;
    btn.onclick = () => handleChoice(text);
    box.appendChild(btn);
  });
}

/* ========= é‡‘ç®±å­æ‰è½é‚è¼¯ï¼ˆç¥å™¨å„ªå…ˆ & ä¸é‡è¤‡ï¼‰ ========= */
function openTreasure() {
  let available = artifactPool.filter(a => !player.artifacts.includes(a));
  if (available.length > 0) {
    let pick = available[Math.floor(Math.random() * available.length)];
    player.artifacts.push(pick);
    return `ä½ æ‰“é–‹äº†é‡‘è‰²å¯¶ç®±ï¼Œç²å¾—ç¥å™¨ï¼š<span class="highlight">${pick}</span>`;
  } else {
    let gold = Math.floor(Math.random() * 200) + 100;
    player.gold += gold;
    return `å¯¶ç®±å…§æ²’æœ‰æ–°ç¥å™¨ï¼Œæ”¹ç²å¾— <span class="highlight">${gold}</span> é‡‘å¹£ï¼`;
  }
}

/* ========= å„ç¨®äº‹ä»¶ ========= */
function battleEvent() {
  player.gold += 50;
  updateUI(`ä½ é­é‡æ€ªç‰©ï¼ğŸ”¥ å¿…å®šæš´æ“Šé€ æˆ <span class="highlight">${player.atk * 2}</span> å‚·å®³ä¸¦å‹åˆ©ï¼<br>ğŸ’° ç²å¾— 50 é‡‘å¹£`);
  renderChoices(["ç¹¼çºŒå‰é€²"]);
}

function shopEvent() {
  updateUI(`ä½ é‡åˆ°äº†å•†äºº ğŸ›’<br>èŠ±è²» 50 é‡‘å¹£å¯æ°¸ä¹…æå‡ 5 æ”»æ“ŠåŠ›ï¼`);
  renderChoices(["è³¼è²·æå‡", "è·³é"]);
}

function healEvent() {
  player.hp = Math.min(player.maxHp, player.hp + 40);
  updateUI(`ä½ å®‰å…¨åœ°ä¼‘æ¯äº†ä¸€æœƒï¼Œæ¢å¾©äº† <span class="highlight">40</span> HP`);
  renderChoices(["ç¹¼çºŒå‰é€²"]);
}

function treasureEvent() {
  updateUI(openTreasure());
  renderChoices(["ç¹¼çºŒå‰é€²"]);
}

function bossEvent() {
  let msg = `ğŸ‘‘ Bosså‡ºç¾ï¼ç¬¬ <span class="highlight">${player.floor}</span> å±¤å®ˆé–€äººå‡è¦–è‘—ä½ ...<br>
      ğŸ’¨ ä½ é¸æ“‡é€ƒè·‘ â€”â€” æ°¸é æˆåŠŸï¼<br>
      Boss è¢«é–ƒå…‰åš‡åˆ°ï¼Œè½ä¸‹ç¥å™¨ï¼š<br><br>
      ${openTreasure()}<br><br>
      â¤ï¸ ä½ å®Œå…¨æ¢å¾©ç”Ÿå‘½ï¼`;
  player.hp = player.maxHp;
  updateUI(msg);
  renderChoices(["é€²å…¥ä¸‹ä¸€è¼ª"]);
}

/* ========= é¸é …è¡Œç‚º ========= */
function handleChoice(choice) {
  if (choice === "è³¼è²·æå‡") {
    if (player.gold >= 50) {
      player.gold -= 50;
      player.atk += 5;
      alert("âš”ï¸ æ”»æ“ŠåŠ› +5ï¼");
    } else {
      alert("é‡‘å¹£ä¸è¶³ï¼");
    }
  }
  player.floor++;
  nextEvent();
}

/* ========= ä¸»åŸ·è¡Œäº‹ä»¶ ========= */
function nextEvent() {
  updateUI();
  const evt = getEvent(player.floor);
  if (evt === "battle") battleEvent();
  if (evt === "shop") shopEvent();
  if (evt === "heal") healEvent();
  if (evt === "treasure") treasureEvent();
  if (evt === "boss") bossEvent();
}

/* ========= éŠæˆ²é–‹å§‹ ========= */
nextEvent();
</script>
</body>
</html>